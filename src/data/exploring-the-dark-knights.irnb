{"cells":[{"metadata":{"_uuid":"bcb88ca030d2a91352353b99b9d6f090cd31870c","_execution_state":"idle","trusted":true},"cell_type":"code","source":"## Importing packages\nlibrary(tidyverse) # metapackage with lots of helpful functions\nlibrary(ggplot2)\nlibrary(scales)\nlibrary(countrycode)\n## Reading in files\n\n# You can access files from datasets you've added to this kernel in the \"../input/\" directory.\n# You can see the files added to this kernel by running the code below. \n\nlist.files(path = \"../input\")\n\n## Saving data\n\n# If you save any files or images, these will be put in the \"output\" directory. You \n# can see the output directory by committing and running your kernel (using the \n# Commit & Run button) and then checking out the compiled version of your kernel.","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"592cbd82eea473f77c678557d8375f36a607e5a5"},"cell_type":"markdown","source":"In this analysis, I will try to use the [tidyverse style](http://style.tidyverse.org/) for coding. Since I am new to it, I will try to use it for as much code as possible. Let's start by reading the data as a tibble (I prefer tibbles over data frames as they are much easier to read and handle)."},{"metadata":{"trusted":true,"_uuid":"159ae2f7b6f043965e428e00670a55c451658a38"},"cell_type":"code","source":"agora = read_csv(\"../input/Agora.csv\")","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"scrolled":true,"_uuid":"3508193420201cdac581a21a8f1769565a6f15f2"},"cell_type":"code","source":"dim(agora)","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"7a3f6c365f1d7beda64cb9b7be36a79ba0df74fe"},"cell_type":"code","source":"head(agora)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"532dc267f2a8cfb99ae240c99cd8d79514a3db25"},"cell_type":"markdown","source":"Let us find out the columns with missing values before we start using the data directly in our analysis. This will help us avoid errors we may run into while handling columns with missing values without knowing about it."},{"metadata":{"trusted":true,"_uuid":"69029de52833f5f9c92f0243bd41eabc2a0842ff"},"cell_type":"code","source":"colnames(agora)[colSums(is.na(agora)) > 0]","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"efbd44c0d91885d3b3e294b46c1e605d670458ec"},"cell_type":"markdown","source":"All the columns except _Vendor_ and _Category_ contain some missing values. Let's look at how many different vendors we have in our data."},{"metadata":{"trusted":true,"_uuid":"768112e1c2bb1d126d90e6375310033b59ca7bae"},"cell_type":"code","source":"length(unique(agora$Vendor))","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"a5df20726a238b0ceb45be041e6e2e1a899931ba"},"cell_type":"markdown","source":"That's a lot of vendors there! Let's try to figure out the top 15 vendors by the number of listings in the dataset."},{"metadata":{"trusted":true,"_uuid":"7ae20b715fa1c9b27564e6135fbf9232ab7ceb03"},"cell_type":"code","source":"(top_15_listings <- agora %>% \n    group_by(Vendor) %>% \n    summarise(Listings = n()) %>% \n    top_n(15) %>% \n    arrange(desc(Listings)))","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"2f9b30945726044fd907e28711d1907aca061714"},"cell_type":"code","source":"options(repr.plot.width = 6, repr.plot.height = 4.5)\ntop_15_listings %>% \n    ggplot(aes(reorder(Vendor, Listings), Listings)) +\n    geom_bar(fill = \"orange\", colour = \"red\", stat = \"identity\") +\n    xlab(\"Vendor\") +\n    coord_flip()","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"1342bd963d64896b918f845fc397f877d1ce15a7"},"cell_type":"markdown","source":"We see that some vendors like **optiman** **sexyhomer** **mssource** and **profesorhouse** have the highest number of listings on Agora. Probably they are the ones with the largest customer base and with the greatest control over the market! Let's look at some of the categories in which the dark market has the largest . Any guesses? You are probably right! "},{"metadata":{"trusted":true,"_uuid":"780f0d974bbc98e4f5e48a5e6aea7538a5fa3ede"},"cell_type":"code","source":"(top_15_category <- agora %>% \n    group_by(Category) %>% \n    summarise(Count_Category = n()) %>% \n    arrange(desc(Count_Category)) %>% \n    top_n(15))","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"834483640047bc6b5b707c94c514155b2b2a8d5c"},"cell_type":"code","source":"top_15_category %>% \n    ggplot(aes(reorder(Category, Count_Category), Count_Category)) +\n    geom_bar(fill = \"yellow\", colour = \"orange\", stat = \"identity\") +\n    xlab(\"Category\") +\n    coord_flip()","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"f7117c07982d7d124fddd70c8a10df4e8dd33f3b"},"cell_type":"markdown","source":"Weed takes it away by a far greater margin than any other sub-category.  Let us try to see how much percentage share of market do these categories take in order to understand this comparison with numbers."},{"metadata":{"trusted":true,"_uuid":"a72963a0f069d0b33678f6296ff681df15b2d28b"},"cell_type":"code","source":"(top_15_category <- top_15_category %>% \n    mutate(Share = Count_Category/sum(Count_Category)*100))","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"cf0e03c1815a966ba30bf19664104388eccd911c"},"cell_type":"markdown","source":"Weed comprises of a massive 27.7% of the total market share of the top 15 categories on the dark market which may not be that surprising! Let us separate __Category__ into different columns __Category__,  __Sub_Category__, and __Product__."},{"metadata":{"trusted":true,"_uuid":"1588d8cd09c75dd7e40567471c2358fd58c4b5c7"},"cell_type":"code","source":"agora <- agora %>% \n    separate(Category, into = c(\"Category\", \"Sub_Category\", \"Product\"),\n             sep = \"/\", fill = \"warn\")","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"5ec4687b240af247a31dc24517846a326e96f818"},"cell_type":"code","source":"# Distribution of different products over different categories\nagora %>% \n    group_by(Category, Sub_Category) %>% \n    summarise(Count_Product = n()) %>% \n    arrange(desc(Count_Product))","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"c3e6c323d99303a88fb3ee549d9c36cd61873db7"},"cell_type":"markdown","source":"We can clearly see that the _Drug_ market takes all away. A slight eyeballing reveals that _Services_ and _Data_ category are also among the top after the King!"},{"metadata":{"trusted":true,"_uuid":"48baa67457c986e4d6a4766f76af204a41a4f02f"},"cell_type":"code","source":"# Looking at the distribution of number of products in different categories\nagora %>%  \n    group_by(Category) %>% \n    summarise(Count = n()) %>% \n    arrange(desc(Count))","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"cac0bb60f81be65d5a0ec21b3899bbc051349ac6"},"cell_type":"markdown","source":"Let's look at the children knights of the king to see which one has the highest share for the King's wealth!"},{"metadata":{"trusted":true,"_uuid":"42cf687824a63800dcaf12c9f29f597a1f7e04f5"},"cell_type":"code","source":"# Looking at the distribution of different categories of drugs\nagora %>% \n    filter(Category == \"Drugs\") %>% \n    group_by(Sub_Category) %>% \n    summarise(Count_Product = n()) %>% \n    arrange(desc(Count_Product)) %>% \n    mutate(Share = Count_Product / sum(Count_Product) * 100)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"86dbc696b2470d4efe22831a54c8feb3bb899467"},"cell_type":"markdown","source":"Cannbis leads the drug market with the largest share of 33.5 percent of all the drugs sold on the dark market. I am really curious to see the percentage of market share that Cannabis holds when compared to all the dark market. Let's try to figure it out!"},{"metadata":{"trusted":true,"_uuid":"b63dffac0571a292a44b09b8f5dbb1dc4a2824b8"},"cell_type":"code","source":"agora %>% \n    group_by(Sub_Category) %>% \n    summarise(Count_Product = n()) %>% \n    arrange(desc(Count_Product)) %>% \n    mutate(Share = Count_Product / sum(Count_Product) * 100) %>% \n    filter(Share > 5)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"c72ad7638daae5429703c1f5ff989b48a0522109"},"cell_type":"markdown","source":"See! What else did you expect? People are crazy about Cannabis on the drug market! Let's look at the distribution of some services below."},{"metadata":{"trusted":true,"_uuid":"d466605208b38e557f9b672c485abe1e0644be60"},"cell_type":"code","source":"# Looking at the distribution of different categories of services\nagora %>% \n    filter(Category == \"Services\") %>% \n    group_by(Sub_Category) %>% \n    summarise(Count_Product = n()) %>% \n    arrange(desc(Count_Product))","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"3b11b00d60ffa00c9671bfd8600e4211ca368fc8"},"cell_type":"markdown","source":"Seems okay.. Nothing groundbreaking as the Cannabis here. Let's move on to the Price now. I see there is a price and a currency asociated with it. I am guessing it's mostly in Bitcoin since it is online but let's get the answer from the data itself."},{"metadata":{"trusted":true,"_uuid":"cd69af1ba734f094ec0173e7901745a707c1ff17"},"cell_type":"code","source":"agora %>% \n    separate(Price, c(\"Price\", \"Currency\"), \" \") %>% \n    select(Currency) %>% \n    group_by(Currency) %>% \n    summarise(Count = n())\n","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"25a18266d62c0b42e4a996c8b8aade0ed0f39e7e"},"cell_type":"markdown","source":"Indeed, the mode of currency is Bitcoin mostly! We can ignore the other entries (probably data entry error or someone was high on LSD while filling the data, you never know!)."},{"metadata":{"trusted":true,"scrolled":false,"_uuid":"17ef6bd085047bdec1e7f259313a4c0a30cc44d1"},"cell_type":"code","source":"agora <- agora %>% \n    separate(Price, c(\"Price\", \"Currency\"), \" \")","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"c9dd5e7fda141dad8fe390e82d6fb6b1560d882f"},"cell_type":"markdown","source":"Now, I personally don't get an idea of the price in BTC since it is so volatile and it is better to have a price in a currency we understand and which is less volatile. So, let us go with USD and since the data obtained is from the period 2014 to 2015, let's take the average conversion rate between BTC and USD for that period which is 340$ approximately (a quick google search)."},{"metadata":{"trusted":true,"_uuid":"8684551b3d6d0e663854dc2d808c5c1f176556d0"},"cell_type":"code","source":"agora <- agora %>% \n    mutate(Price = as.numeric(Price) * 340, Currency = \"USD\") %>% \n    filter(!is.na(Price))","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"fffd1f72ba82ca33aa31ee779dc2bb2199cdcea0"},"cell_type":"markdown","source":"Let us now try to plot the distribution of Price to get an idea of the mean price for all the stuff available on the dark web/market."},{"metadata":{"trusted":true,"_uuid":"32c23a4ae408f4c5b1f52e40643029c8d4c62a95"},"cell_type":"code","source":"agora %>% \n    ggplot(aes(x = Price)) +\n    geom_histogram(bins = 40)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"c7edcf08fbcca4eb914165d58544af271dd0b959"},"cell_type":"markdown","source":"Damn! I wasn't expecting this one bar histogram. I bet you weren't too. But this is the beauty of Exploratory Data Analysis. It helps us look and understand our data better without having to see and gauge a lot of numbers. We didn't need to compare the max price to the other prices in order to see here that there are a lot of products with less price and only a few with a really high price (as is expected). Let us see here what's going on and then try to make things more clear."},{"metadata":{"trusted":true,"_uuid":"80f52f37f26b4f714fd07eb688450ff81b8adc97"},"cell_type":"code","source":"summary(agora$Price)","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"ef6716bcab60063bef16fa5234d3391f543c8346"},"cell_type":"code","source":"table(agora$Price > mean(agora$Price) + 6 * sd(agora$Price))","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"d5b57d802a4c1ee16b729a460ffb7a5111ae60d1"},"cell_type":"markdown","source":"There are some serious outliers there in our dataset and I know what you're thinking. What is the that thing with such a high price? Let's figure it out!"},{"metadata":{"trusted":true,"_uuid":"2c059e68a6ff47f30f17dd1697f875cd25ebbaae"},"cell_type":"code","source":"agora %>% \n    filter(Price > mean(Price) + 6 * sd(Price)) %>% \n    arrange(desc(Price)) %>% \n    head()","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"38c3f88219626d15cf6399f025430bb7492f7ab3"},"cell_type":"markdown","source":"Are you even surprised now that the item with the highest price is a Drug? I am definitely not! So it is called Speed and it's a type of a Stimulant. Wait for now, you can search more about it on Google later! I know this is too interesting to not google up! So these guys \"HAPPyholland\" are so confident in their product that they just ask you to check out their reviews (see the text in the item column). I guess the criteria is legit!"},{"metadata":{"trusted":true,"_uuid":"7b5cbde50c75beabfcc179471a872d28d0e55202"},"cell_type":"code","source":"agora %>% \n    filter(Price > mean(Price) + 6 * sd(Price)) %>% \n    arrange(desc(Price)) %>% \n    group_by(Category) %>% \n    summarise(Count = n())","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"508bb3f35fceebf74fd564e6d0f16d7f00c222c5"},"cell_type":"markdown","source":"Almost all the top outliers in price are Drugs. Let us see if we can get a better view of the distribution through the histogram category-wise."},{"metadata":{"trusted":true,"_uuid":"8c7a70419fbc76fd040d52a14cf19182ee7c982e"},"cell_type":"code","source":"agora %>% \n    ggplot(aes(x = Price)) +\n    geom_histogram(bins = 40) +\n    xlim(c(0, 10^3))","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"e2d6ee06470b77fa01d3340fde9a8c149ee96ba3"},"cell_type":"markdown","source":"The distribution is right-skewed. This means that the Price values highly assymmetric which makes sense in the real world. There will be a lot of items sold at a lower price but not so many items that being sold at a really high price. \n\nWe can remove the right-skewness of the distribution by taking the log transformation."},{"metadata":{"trusted":true,"_uuid":"41c4df47b566b3121b6125abae9b9afc804920de"},"cell_type":"code","source":"agora %>% \n    ggplot(aes(x = Price)) +\n    geom_histogram(binwidth = 0.3) +\n    scale_x_log10() +\n    labs(x = \"Price (USD)\")","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"a15a41fe3ee1335bf65daf70829614a3393f295d"},"cell_type":"markdown","source":"Let us plot the price distribution (in log scale) for all the categories. The distributions obtained are expected to be nearly normal since we are using the log transformation on prices and as we see, they are!"},{"metadata":{"trusted":true,"_uuid":"9bfc71c29d00ee324e880bd695de820ee9ced996"},"cell_type":"code","source":"agora %>% \n    group_by(Category) %>% \n    ggplot(aes(x = Price)) +\n    geom_histogram(bins = 40) +\n    scale_x_log10() +\n    labs(x = \"Price (USD) - log scale\") +\n    facet_wrap(~ Category, scales = \"free\", ncol = 4)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"72fc9b91cf21a34de19343d7f297cff2ec0c5285"},"cell_type":"markdown","source":"Looking at what we have in the data, I am now really curious about what are the main points of origin and destination of these products. Let's figure it out!"},{"metadata":{"trusted":true,"_uuid":"14c3f4e34550cd530cd74b3f86600c97ad99f82b"},"cell_type":"code","source":"suppressWarnings(origin <- countrycode(agora$Origin, \"country.name\", \"iso2c\") %>% \n                    as_tibble() %>% \n                    setNames(\"iso\") %>% \n                    filter(!is.na(iso)))\nsuppressWarnings(dest <- countrycode(agora$Destination, \"country.name\", \"iso2c\") %>% \n                    as_tibble() %>% \n                    setNames(\"iso\") %>% \n                    filter(!is.na(iso)))","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"d045cee32b1a6356a34e999be13ca8279cb84058"},"cell_type":"markdown","source":"Now we look at the counts of rows with different origins and destinations to see which areas are the most popular."},{"metadata":{"trusted":true,"_uuid":"e291290bb08b961cf7faae6a77bcc94d556dd6dd"},"cell_type":"code","source":"origin %>% \n    group_by(iso) %>% \n    summarise(freq = n()) %>% \n    filter(freq > 100) %>% \n    arrange(desc(freq)) %>% \n    mutate(prop = freq / sum(freq) * 100)","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"f3b4ead91090ed4b1e051b983f0d87c769e5e560"},"cell_type":"code","source":"dest %>% \n    group_by(iso) %>% \n    summarise(freq = n()) %>% \n    filter(freq > 5) %>% \n    arrange(desc(freq)) %>% \n    mutate(prop = freq / sum(freq) * 100)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"6cdd376379a61abb0de0505d06cbb8e5616eb961"},"cell_type":"markdown","source":"The US is way above any other country by comparison and is clearly the winner with about 40% of the market share in origin and 64% of the market share in destination (these are huge numbers, enough to conclude US as the king of this kingdom!). But we also have a lot of other interesting origin and destination countries to look at. We will try to plot these countries on the world map according to their frequency in the dataset. We will use map_data for this purpose which comes with ggplot2."},{"metadata":{"trusted":true,"_uuid":"c1f0a2f70096732d90a8ba76f73fe5a2c6262080"},"cell_type":"code","source":"world_data <- map_data(\"world\") %>% \n    as_tibble() %>% \n    mutate(iso = countrycode(region, \"country.name\", \"iso2c\"))","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"020cb56f01222585711bea2b06818a819168091f"},"cell_type":"code","source":"paste(\"Origin Countries\")\n(origin <- origin %>% \n    group_by(iso) %>% \n    summarise(freq = n()) %>% \n    filter(freq > 1000, iso != \"US\") %>% \n    arrange(desc(freq)))\npaste(\"Destination Countries\")\n(dest <- dest %>% \n    group_by(iso) %>% \n    summarise(freq = n()) %>% \n    filter(freq > 50, iso != \"US\") %>% \n    arrange(desc(freq)))","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"f50a26f218783994087b56d922d3d3d3f2c46cae"},"cell_type":"markdown","source":"We will now perform a left outer join on the two tables. To understand more about joins, look at [this awesome CheatSheet](http://stat545.com/bit001_dplyr-cheatsheet.html)."},{"metadata":{"trusted":true,"_uuid":"ba418e2d4875132d2b197176067fdab910fe8221"},"cell_type":"code","source":"# Doing a left outer join on the two tables\norigin_data <- left_join(world_data, origin, by = \"iso\") %>% \n    filter(!is.na(freq))\ndest_data <- left_join(world_data, dest, by = \"iso\") %>% \n    filter(!is.na(freq))","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"scrolled":true,"_uuid":"12c0bda5def890a873ab4d6cbbab53c19ea169c2"},"cell_type":"code","source":"ggplot(origin_data, aes(long, lat)) +\n    geom_polygon(aes(group = group, fill = freq)) +\n    labs(x = \"Longitudes\", y = \"Latitudes\", title = \"Origin of Products sold on Agora\") +\n    coord_equal()","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"9a48c5feb10fc8a1ea47ba8062bc7a3ebe090ecb"},"cell_type":"markdown","source":"After the USA, we have in line the Great Britain, Australia, Germany, Netherlands and Canada in that order in terms of the origin countries. Interesting!"},{"metadata":{"trusted":true,"_uuid":"acb1c2011df07ab0f81924e981174347f3f021af"},"cell_type":"code","source":"ggplot(dest_data, aes(long, lat)) +\n    geom_polygon(aes(group = group, fill = freq)) +\n    labs(x = \"Longitudes\", y = \"Latitudes\", title = \"Destination of Products sold on Agora\") +\n    coord_equal()","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"da147c9e40df04738942540dd756c95e699a66f9"},"cell_type":"markdown","source":"Again in terms of the destination, we have Australia, the Great Britain, Germany and Canada in that order which is not a surprise I guess? Let us now move to the rating of the products and look at its distribution."},{"metadata":{"trusted":true,"_uuid":"0b74aad749b2ed527316f87d8c6e5e1181c38284"},"cell_type":"code","source":"# separating the rating into the actual rating and the max rating (5)\nagora <- agora %>% \n    separate(Rating, into = c(\"Rating\", \"Max\"), sep = \"/\") %>% \n    filter(!is.na(Max), Rating != ~5) %>%    #just filtering out some gibberish values created\n    mutate(Rating = as.numeric(Rating))","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"afa19bb7be224d4bccf6bd4820e45aca091c1ff4"},"cell_type":"code","source":"agora %>% \n    filter(Rating > 0) %>% \n    ggplot(aes(x = Rating)) +\n    geom_histogram(bins = 40)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"f5e4e1199ab19b29685b0e34a0ac1554f8a074fb"},"cell_type":"markdown","source":"This is a highly left-skewed distribution. Let's look at the distribution of all the ratings above 4."},{"metadata":{"trusted":true,"_uuid":"4920ad1e0cdc22809b19b904705490abc858cec6"},"cell_type":"code","source":"agora %>% \n    filter(Rating > 4) %>% \n    ggplot(aes(x = Rating)) +\n    geom_histogram(bins = 40)","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"25b66708e7771919bdb753c662e7fa66eca4644c"},"cell_type":"code","source":"agora %>% \n    filter(Rating > 4) %>% \n    ggplot(aes(x = Rating)) +\n    geom_histogram(bins = 40) +\n    facet_wrap(~ Category, scales = \"free\", ncol = 4)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"682ecd2dc950ca3e2e49d0005a32a0687a28f52b"},"cell_type":"markdown","source":"What we can infer from the above plot is that:\n- `weapons` are rated 5 most of the times\n- `counterfeits` and `data` also have good ratings most of the times.\n- `information` is surprisingly rated somewhere near 4.8 instead of 5 most of the times. This may indicate dissatisfaction/less satisfaction of customers for information as comapred to other categories.\n- `jewelry` also surprisingly, has very less amount of 5 ratings (probably the least of all categories). This might reflect the skepticism of customers about whether the jewelry is fake or not.\n\nNow we try to corner out some of the most expensive drug dealers on Agora along with their locations."},{"metadata":{"trusted":true,"_uuid":"172191cf1a78b2eabf8ff0e070888759a29cd06f"},"cell_type":"code","source":"# getting the drug vendors in descneding order of their mean prices\nagora$Vendor = as.factor(agora$Vendor)\n(most_expensive_drug_dealers <- agora %>% \n    filter(Category == \"Drugs\") %>% \n    group_by(Vendor) %>% \n    summarise(avg_price_drugs = mean(Price)) %>% \n    arrange(desc(avg_price_drugs)) %>% \n    top_n(15))","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"4ed098008b8055f27dcd177dc6f2ddbc388c40c8"},"cell_type":"code","source":"most_expensive_drug_dealers %>% \n    ggplot(aes(x = avg_price_drugs, y = fct_reorder(Vendor, avg_price_drugs))) +\n    geom_point() +\n    labs(x = \"Average price of drugs\", y = \"Vendors\")","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"1e17151e8fd7b988ec563f56eb5f7aa2400cbe75"},"cell_type":"code","source":"# getting the drug vendors' origin along with the average price and name\nmost_expensive_dealers_origin <- agora %>% \n    filter(Category == \"Drugs\", Vendor %in% most_expensive_drug_dealers$Vendor) %>% \n    select(Vendor, Origin) %>% \n    filter(!is.na(Origin)) %>% \n    distinct() %>% \n    arrange(Origin)\n\n(most_expensive_drug_dealers <- left_join(most_expensive_drug_dealers, most_expensive_dealers_origin))","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"b9e8f80bb868986327679bc17f49b2cf92cbf7fb"},"cell_type":"markdown","source":"Let us look at the drug dealers with the top 3 highest average prices."},{"metadata":{"trusted":true,"_uuid":"fe33f13a41910a45f84f8cce7e895d41b36efc31"},"cell_type":"code","source":"agora %>% \n    filter(Vendor %in% most_expensive_drug_dealers$Vendor) %>% \n    group_by(Vendor, Origin) %>% \n    summarise(Count = n()) %>% \n    filter(Vendor %in% c(\"heroking\", \"EdWestwick\", \"Houba\"))","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"4c13c62937785357458aea371e084cfa7c085663"},"cell_type":"markdown","source":"It seems that `heroking` (with the highest average price in drugs category) operates solely from 1 location (`Netherlands`). The second most expensive dealer has their hub in `China` and the third most expensive dealer operaets from the `USA`. \n\nApart from drugs, the other category which is highly unsafe for people is `Weapons`. Let us do a similar analysis for `Weapons` to corner out the main dealers for this category."},{"metadata":{"trusted":true,"_uuid":"b6461295612869b673212c887b01013826ce5ad3"},"cell_type":"code","source":"# getting the weapon vendors in descneding order of their mean prices\n(most_expensive_weapon_dealers <- agora %>% \n    filter(Category == \"Weapons\") %>% \n    group_by(Vendor) %>% \n    summarise(avg_price_weapons = mean(Price)) %>% \n    arrange(desc(avg_price_weapons)) %>% \n    top_n(15))","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"7537b7130f87d198e704d7f218336307431d2873"},"cell_type":"markdown","source":"There seems to be a clear winner in this cateogry as the king of the dealers (at least this is what seems like from this table!). The average price by the `echo` is huge! We will ignore our king in the plot otherwise we won't be able to get a meaningful plot and won't be able to compare the relative monopoly of the other weapon dealers."},{"metadata":{"trusted":true,"_uuid":"75d2b28459162b3fd876f5a942dfefdfae410270"},"cell_type":"code","source":"most_expensive_weapon_dealers %>% \n    filter(Vendor != \"echo\") %>% \n    ggplot(aes(x = avg_price_weapons, y = fct_reorder(Vendor, avg_price_weapons))) +\n    geom_point() +\n    labs(x = \"Average price of weapons\", y = \"Vendors\")","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"bfd96f0e1b393ff0f393f4269bad67be26dad78d"},"cell_type":"markdown","source":"I really like the names of these vendors! Like the `subwaygal`, `TheHappyGuy` and `frygirlswirl`? Too exotic to be doing something legal! Won't you agree?"},{"metadata":{"trusted":true,"_uuid":"eaa0399bfa9c35a8979199c71ce3786aea48fc08"},"cell_type":"code","source":"","execution_count":null,"outputs":[]}],"metadata":{"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"3.4.2","file_extension":".r","codemirror_mode":"r"}},"nbformat":4,"nbformat_minor":1}