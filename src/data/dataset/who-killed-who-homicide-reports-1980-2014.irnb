{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "19b5240b-d463-1e78-eb8f-bfa47cb9434b"
      },
      "source": [
        "**Exploring Homicide Reports 1980-2014!**\n",
        "\n",
        "Hello, \n",
        "\n",
        "Welcome to my new Kernel about Homicide Report created for Kaggelers by the Kaggel Team member Abigail Larion.\n",
        "I do not promise doing so much things in this Kernel, as I am usually do some Data summary with exploratory plots, so to figure out the aim behind the data-set and ask a simple question that how those features can help me to get the target of finding a serial killer -if any- hiding between the rows and fields...\n",
        "\n",
        "\n",
        "Although it is hard to achieve the said target and knowing that the process of features engineering \n",
        "has an essential rule here, I will try to do so, cautiously of course, since i am not a detective or a police officer and have no experience in doing crime investigation...\n",
        "\n",
        "I am going to start by summarizing the data-set to understand it and then i will do filtering and grouping\n",
        "strangely, I do not know why I\u2019m interesting in knowing Who Killed Who at this stage. Let's see..\n",
        "\n",
        "of course I rely on your understanding, comments and your contributions.\n",
        "\n",
        "Let's Start in Reading the Dataset."
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "03e9fa37-0cea-c816-f00f-e39f2bc9a181"
      },
      "source": [
        "**In this section I will continue what I have started at the last kernel, I will try to see what these data have to tell me about the incidents happened between Friends!**\n",
        "\n",
        "You can check in the Filtering section..."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "596aa66c-3749-d7ae-077a-7c4ec71d79de"
      },
      "outputs": [],
      "source": [
        "homi.r <- read.csv(\"../input/database.csv\")\n",
        "suppressMessages(attach(homi.r))\n",
        "options(warn=-1)\n",
        "# head(homi.r)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "6da8c310-7252-ff1a-9056-4c33fccecad9"
      },
      "outputs": [],
      "source": [
        "# Libraries\n",
        "\n",
        "warn.conflicts = FALSE\n",
        "suppressMessages(library(plyr))\n",
        "suppressMessages(library(tidyr))\n",
        "suppressMessages(library(stringr))\n",
        "suppressMessages(library(stringi))\n",
        "suppressMessages(library(dplyr))\n",
        "suppressMessages(library(forcats))\n",
        "suppressMessages(library(ggplot2))\n",
        "suppressMessages(library(gridExtra))\n",
        "suppressMessages(library(Hmisc))"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "61ce4478-f38b-d3c0-04cb-305c86d2235e"
      },
      "source": [
        "# Summary"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "4f2aaf51-8862-2154-dd73-c35aeb627c17"
      },
      "outputs": [],
      "source": [
        "# str(homi.r)\n",
        "# dim(homi.r)\n",
        "# [1] 638454     24\n",
        "# class(homi.r)\n",
        "# [1] \"data.frame\"\n",
        "# length(unique(homi.r$Record.ID))\n",
        "# [1] 638454\n",
        "# anyDuplicated(homi.r$Record.ID)\n",
        "# [1] 0\n",
        "# anyNA(homi.r)\n",
        "# [1] TRUE\n",
        "# names(homi.r)\n",
        "\n",
        "# [1] \"Record.ID\"             \"Agency.Code\"           \"Agency.Name\"           \"Agency.Type\"          \n",
        "# [5] \"City\"                  \"State\"                 \"Year\"                  \"Month\"                \n",
        "# [9] \"Incident\"              \"Crime.Type\"            \"Crime.Solved\"          \"Victim.Sex\"           \n",
        "# [13] \"Victim.Age\"            \"Victim.Race\"           \"Victim.Ethnicity\"      \"Perpetrator.Sex\"      \n",
        "# [17] \"Perpetrator.Age\"       \"Perpetrator.Race\"      \"Perpetrator.Ethnicity\" \"Relationship\"         \n",
        "# [21] \"Weapon\"                \"Victim.Count\"          \"Perpetrator.Count\"     \"Record.Source\"\n",
        "\n",
        "##########################"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "8658b0f9-3eba-069a-169a-3f613ce15af6"
      },
      "source": [
        "**I think it is better to change the manes to lower case.**"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "02c2eb00-2fa3-4840-d5fe-af73b83943d5"
      },
      "outputs": [],
      "source": [
        "names(homi.r) <- tolower(names(homi.r))\n",
        "# names(homi.r)\n",
        "# [1] \"record.id\"             \"agency.code\"           \"agency.name\"           \"agency.type\"          \n",
        "# [5] \"city\"                  \"state\"                 \"year\"                  \"month\"                \n",
        "# [9] \"incident\"              \"crime.type\"            \"crime.solved\"          \"victim.sex\"           \n",
        "# [13] \"victim.age\"            \"victim.race\"           \"victim.ethnicity\"      \"perpetrator.sex\"      \n",
        "# [17] \"perpetrator.age\"       \"perpetrator.race\"      \"perpetrator.ethnicity\" \"relationship\"         \n",
        "# [21] \"weapon\"                \"victim.count\"          \"perpetrator.count\"     \"record.source\"   "
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "eb473d03-000e-eca2-0141-a06bde56798e"
      },
      "source": [
        "**Question :** what incident feature stands for in here? ...the minimum is 0 and the maximum is 999 incidents,\n",
        "considering that the age and the sex features are referring to one person...\n",
        "are they the incidents generated or affected by the main incident?\n",
        "\n",
        "Although i believe it is a very important question, i will skip it for now.\n",
        " \n",
        "Let' go ahead"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "3f382623-dcb6-c38a-d1d4-1630c5e61ea1"
      },
      "outputs": [],
      "source": [
        "# sapply(homi.r[1,],class)\n",
        "\n",
        "# record.id           agency.code           agency.name           agency.type                  city \n",
        "# \"integer\"              \"factor\"              \"factor\"              \"factor\"              \"factor\" \n",
        "# state                  year                 month              incident            crime.type \n",
        "# \"factor\"             \"integer\"              \"factor\"             \"integer\"              \"factor\" \n",
        "# crime.solved            victim.sex            victim.age           victim.race      victim.ethnicity \n",
        "# \"factor\"              \"factor\"             \"integer\"              \"factor\"              \"factor\" \n",
        "# perpetrator.sex       perpetrator.age      perpetrator.race perpetrator.ethnicity          relationship \n",
        "# \"factor\"             \"integer\"              \"factor\"              \"factor\"              \"factor\" \n",
        "# weapon          victim.count     perpetrator.count         record.source "
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "08ac4690-c84b-5bf2-6b42-3b631cb84a12"
      },
      "outputs": [],
      "source": [
        "# Ok! I think I will create new data frame filtering the crime solved to \"YES\", \n",
        "# i want to go from what we know to what we don\u2019t\n",
        "\n",
        "# levels(homi.r$crime.solved)\n",
        "# [1] \"No\"  \"Yes\"\n",
        "# no missing data in this feature, Great!\n",
        "\n",
        "# length(homi.r$crime.solved[homi.r$crime.solved == \"Yes\"])\n",
        "# [1] 448172 \n",
        "# 448172 / 638454 = 0.70  realy nice 70 %"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "68b8f4ef-806a-a8f9-4a5d-f0dfd1f4a6d3"
      },
      "source": [
        "# Filtering"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "935c9164-1b74-87c0-2882-3a3714803480"
      },
      "outputs": [],
      "source": [
        "###### crime solved = yes\n",
        "\n",
        "homi.r.solved <- homi.r %>% filter(\n",
        "                                    crime.solved    == \"Yes\" &\n",
        "                                    victim.sex      != \"Unknown\" &\n",
        "                                    perpetrator.sex != \"Unknown\" &\n",
        "                                    relationship    != \"Unknown\"\n",
        ")%>%\n",
        "  droplevels()\n",
        "\n",
        "##############################################\n",
        "girl.boy.crime<-homi.r %>% filter(\n",
        "                                    relationship  %in% c(\"Girlfriend\",\"Boyfriend\") &\n",
        "                                    victim.age      >= 18 &\n",
        "                                    perpetrator.age >= 18 &\n",
        "                                    victim.sex      != \"Unknown\" &\n",
        "                                    perpetrator.sex != \"Unknown\"\n",
        ") %>%\n",
        "  droplevels() %>%\n",
        "  select(record.id, agency.type,city,state,year,month,crime.type,\n",
        "         crime.solved,victim.sex,victim.age,victim.race,victim.ethnicity,perpetrator.sex,\n",
        "         perpetrator.age,perpetrator.race,perpetrator.ethnicity,relationship,weapon,record.source)\n",
        "\n",
        "# table(girl.boy.crime$victim.sex)\n",
        "# Female   Male \n",
        "#   7468   3619\n",
        "# table(girl.boy.crime$perpetrator.sex)\n",
        "# Female   Male \n",
        "#   3460   7627\n",
        "\n",
        "# something wrong !!!\n",
        "\n",
        "girl.boy.crime<-girl.boy.crime[!(girl.boy.crime$victim.sex==girl.boy.crime$perpetrator.sex),]\n",
        "\n",
        "# table(girl.boy.crime$victim.sex)\n",
        "# Female   Male \n",
        "# 7434   3426 \n",
        "# table(girl.boy.crime$perpetrator.sex)\n",
        "# Female   Male \n",
        "# 3426   7434 \n",
        "\n",
        "# now it is OK \n",
        "\n",
        "############################################\n",
        "\n",
        "# Who killed Who (Familicide). Unfortunately !\n",
        "\n",
        "\n",
        "homi.r.solved <- homi.r.solved %>% \n",
        "  mutate(who.killed.who = case_when(.$relationship==\"Brother\" &\n",
        "                                      .$perpetrator.sex ==\"Male\" ~ \"Brother Killed by Brother\",\n",
        "                                    .$relationship==\"Brother\" & \n",
        "                                      .$perpetrator.sex ==\"Female\" ~ \"Brother Killed by Sister\",\n",
        "                                    .$relationship==\"Sister\" & \n",
        "                                      .$perpetrator.sex ==\"Female\" ~ \"Sister Killed by Sister\",\n",
        "                                    .$relationship==\"Sister\" & \n",
        "                                      .$perpetrator.sex ==\"Male\" ~ \"Sister Killed by Brother\",\n",
        "                                    .$relationship==\"Mother\" & \n",
        "                                      .$perpetrator.sex ==\"Male\" ~ \"Mother Killed by Son\",\n",
        "                                    .$relationship==\"Mother\" & \n",
        "                                      .$perpetrator.sex ==\"Female\" ~ \"Mother Killed by Sister\",\n",
        "                                    .$relationship==\"Son\" & \n",
        "                                      .$perpetrator.sex ==\"Female\" ~ \"Son Killed by Mother\",\n",
        "                                    .$relationship==\"Son\" & \n",
        "                                      .$perpetrator.sex ==\"Male\" ~ \"Son Killed by Father\",\n",
        "                                    .$relationship==\"Daughter\" & \n",
        "                                      .$perpetrator.sex ==\"Female\" ~ \"Daughter Killed by Mother\",\n",
        "                                    .$relationship==\"Daughter\" & \n",
        "                                      .$perpetrator.sex ==\"Male\" ~ \"Daughter Killed by Father\",\n",
        "                                    .$relationship==\"Wife\" & \n",
        "                                      .$perpetrator.sex ==\"Male\" ~ \"Wife Killed by Husband\",\n",
        "                                    .$relationship==\"Husband\" & \n",
        "                                      .$perpetrator.sex ==\"Female\" ~ \"Husband Killed by wife\",\n",
        "                                    .$relationship==\"Father\" & \n",
        "                                      .$perpetrator.sex ==\"Female\" ~ \"Father Killed by Daughter\",\n",
        "                                    .$relationship==\"Father\" & \n",
        "                                      .$perpetrator.sex ==\"Male\" ~ \"Father Killed by Son\",\n",
        "                                    TRUE~\"UKN\"))\n",
        "\n",
        "\n",
        "ex.husband.ex.wife.crime<-homi.r %>% filter(\n",
        "                                            relationship     %in% c(\"Ex-Husband\",\"Ex-Wife\") &\n",
        "                                            victim.age       >= 18 &\n",
        "                                            perpetrator.age  >= 18 &\n",
        "                                            victim.sex      != \"Unknown\" &\n",
        "                                            perpetrator.sex != \"Unknown\"\n",
        ") %>%\n",
        "  droplevels() %>%\n",
        "  select(record.id, agency.type,city,state,year,month,crime.type,\n",
        "         crime.solved,victim.sex,victim.age,perpetrator.sex,\n",
        "         perpetrator.age,relationship,weapon)\n",
        "\n",
        "# there are Female in both features victim .sex and perpetrator.sex ..and Male as well which is wrong..!\n",
        "# so I consider that the victim sex to be my reference because it is the subject of this dataset.\n",
        "ex.husband.ex.wife.crime$relationship <- ifelse(ex.husband.ex.wife.crime$victim.sex==\"Male\",\n",
        "                                                \"Ex-Husband\",\"Ex-Wife\")\n",
        "# I think there was some typo here \n",
        "\n",
        "# OK let's move on\n",
        "\n",
        "ex.husband.ex.wife.crime$older.or.younger <- ifelse(ex.husband.ex.wife.crime$relationship==\"Ex-Husband\" &\n",
        "                                                      ex.husband.ex.wife.crime$perpetrator.age < ex.husband.ex.wife.crime$victim.age,\n",
        "                                                    \"Ex-wife Killed an old Ex-Husband\",\n",
        "                                                    ifelse(ex.husband.ex.wife.crime$relationship==\"Ex-Husband\" &\n",
        "                                                             ex.husband.ex.wife.crime$perpetrator.age > ex.husband.ex.wife.crime$victim.age,\n",
        "                                                           \"Ex-wife Killed a young Ex-Husband\",\n",
        "                                                           ifelse(ex.husband.ex.wife.crime$relationship==\"Ex-Wife\" &\n",
        "                                                                    ex.husband.ex.wife.crime$perpetrator.age > ex.husband.ex.wife.crime$victim.age,\n",
        "                                                                  \"Ex- Husband Killed a young Ex-Wife\",\n",
        "                                                                  ifelse(ex.husband.ex.wife.crime$relationship==\"Ex-Wife\" &\n",
        "                                                                           ex.husband.ex.wife.crime$perpetrator.age < ex.husband.ex.wife.crime$victim.age,\n",
        "                                                                         \"Ex-Husband Killed an old Ex-Wife\",\"Smae Age\"))))\n",
        "ndf.by.weapon <- homi.r %>% filter(\n",
        "                                  weapon != \"Unknown\" &\n",
        "                                  victim.sex != \"Unknown\"&\n",
        "                                  perpetrator.sex != \"Unknown\" &\n",
        "                                  victim.age       >= 18 &\n",
        "                                  perpetrator.age  >= 18\n",
        ") %>% \n",
        "  droplevels()%>%\n",
        "  select(record.id, agency.type,city,state,year,month,crime.type,\n",
        "         crime.solved,victim.sex,victim.age,perpetrator.sex,\n",
        "         perpetrator.age,relationship,weapon)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "ba430750-3d9b-7f3b-eb7b-cdb29f8e270b"
      },
      "outputs": [],
      "source": [
        "homi.r$who.killed.who.sex <- ifelse(homi.r$perpetrator.sex==\"Female\"& homi.r$victim.sex==\"Male\",\n",
        "                                    \"Male Killed by Female\",\n",
        "                                    ifelse(homi.r$perpetrator.sex==\"Male\"& homi.r$victim.sex==\"Female\",\n",
        "                                          \"Female Killed by Male\",\n",
        "                                          ifelse(homi.r$perpetrator.sex ==\"Male\" & homi.r$victim.sex == \"Male\",\n",
        "                                                 \"Male Killed by Male\",\n",
        "                                                 ifelse(homi.r$perpetrator.sex ==\"Female\" & homi.r$victim.sex == \"Female\",\n",
        "                                                        \"Female Killed by Female\", \"UNK\"))))"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "69356919-a4be-e9cf-895a-0ef66dc5700f"
      },
      "outputs": [],
      "source": [
        "employee.employer.crime<-homi.r %>% filter(\n",
        "                                           relationship     %in% c(\"Employee\",\"Employer\") &\n",
        "                                           victim.age       >= 18 &\n",
        "                                           perpetrator.age  >= 18 &\n",
        "                                           victim.sex      != \"Unknown\" &\n",
        "                                           perpetrator.sex != \"Unknown\"\n",
        ") %>%\n",
        "  droplevels() %>%\n",
        "  select(record.id, agency.type,city,state,year,month,crime.type,\n",
        "         crime.solved,victim.sex,victim.age,perpetrator.sex,\n",
        "         perpetrator.age,relationship,weapon,who.killed.who.sex)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "27b09af7-48bd-c864-af98-993a5b130856"
      },
      "source": [
        "# Friends"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "60be853a-1e3b-a445-efe8-6ca09cc1a527"
      },
      "outputs": [],
      "source": [
        "friend.crime<-homi.r %>% filter(\n",
        "                                relationship    == \"Friend\" &\n",
        "                                victim.sex      != \"Unknown\" &\n",
        "                                victim.age       >= 18 &\n",
        "                                perpetrator.age  >= 18 &\n",
        "                                perpetrator.sex != \"Unknown\"\n",
        ") %>%\n",
        "  droplevels() %>%\n",
        "  select(record.id, agency.type,city,state,year,month,crime.type,\n",
        "         crime.solved,victim.sex,victim.age,perpetrator.sex,\n",
        "         perpetrator.age,relationship,weapon)\n",
        "\n",
        "friend.crime$who.killed.who.Friend.sex <- ifelse(friend.crime$perpetrator.sex == \"Female\" & friend.crime$victim.sex == \"Male\",\n",
        "                                                 \"Friends Male Killed by Female\",\n",
        "                                                 ifelse(friend.crime$perpetrator.sex == \"Male\"& friend.crime$victim.sex == \"Female\",\n",
        "                                                        \"Friends Female Killed by Male\",\n",
        "                                                        ifelse(friend.crime$perpetrator.sex == \"Male\" & friend.crime$victim.sex == \"Male\",\n",
        "                                                               \"Friends Male Killed by Male\",\n",
        "                                                               ifelse(friend.crime$perpetrator.sex == \"Female\" & friend.crime$victim.sex == \"Female\",\n",
        "                                                                      \"Friends Female Killed by Female\", \"UNK\"))))"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "6d79132f-4d91-e98e-2627-04915f48aacf"
      },
      "source": [
        "If you ask me why i have filtered the data frame by Age to be 18+, i would say that I found some typo here.\n",
        "\n",
        "there were many observations from 0 up to 13 years age which is wired! \n",
        "so i think the relationship for those observations could be step-mother or step-father or it is just typo.\n",
        "\n",
        "more over i found perpetrator .age with 0 age which i think it is Unknown but they put 0 as a number. Maybe?\n",
        " \n",
        "It need more investigation."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "520155fc-0a61-c29c-3110-7314920ce9cf"
      },
      "outputs": [],
      "source": [
        "# table(homi.r.solved$who.killed.who)\n",
        "# Brother Killed by Brother  Brother Killed by Sister Father Killed by Daughter      Father Killed by Son \n",
        "# 5016                       480                       473                      3880 \n",
        "# Husband Killed by Wife Mother Killed by Daughter      Mother Killed by Son  Sister Killed by Brother \n",
        "# 8613                       686                      3549                      1037 \n",
        "# Sister Killed by Sister      Son Killed by Father      Son Killed by Mother                       UKN \n",
        "# 251                      5983                      3859                    296279 \n",
        "# Wife Killed by Husband \n",
        "# 23055 "
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "6d0f6bfc-2b4a-8cbd-0344-71bb68cb27b3"
      },
      "source": [
        "# Summarizing and grouping"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "876012ed-4215-494f-8760-d78b188f93bd"
      },
      "outputs": [],
      "source": [
        "by.year <- summarise(group_by(homi.r,year),freq.year =n())%>%\n",
        "  arrange(desc(freq.year)) \n",
        "\n",
        "by.month <- summarise(group_by(homi.r,month),freq.month =n())%>%\n",
        "  arrange(desc(freq.month))\n",
        "\n",
        "\n",
        "by.family <- summarise(group_by(homi.r.solved[homi.r.solved$who.killed.who!=\"UKN\", ],who.killed.who),total.number.re =n())%>%\n",
        "    arrange(desc(total.number.re))\n",
        "\n",
        "by.state <- summarise(group_by(homi.r,state),freq.by.state =n())%>%\n",
        "  arrange(desc(freq.by.state))\n",
        "\n",
        "\n",
        "by.weapon <- summarise(group_by(ndf.by.weapon,weapon),freq.by.weapon =n())%>%\n",
        "  arrange(desc(freq.by.weapon))\n",
        "\n",
        "by.weapon.sex <- summarise(group_by(ndf.by.weapon,weapon,victim.sex),freq.by.weapon =n())%>%\n",
        "  arrange(desc(freq.by.weapon))\n",
        "\n",
        "ndf.by.weapon$sex.weapon.used <- sprintf(\"%s Killed by %s Using a %s\",\n",
        "                                         ndf.by.weapon$victim.sex,\n",
        "                                         ndf.by.weapon$perpetrator.sex,\n",
        "                                         ndf.by.weapon$weapon)\n",
        "\n",
        "\n",
        "by.ndf.by.weapon.used <- summarise(group_by(ndf.by.weapon,sex.weapon.used),\n",
        "                                   freq.by.weapon.used =n())%>%\n",
        "  arrange(desc(freq.by.weapon.used))"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "49d04af2-99cf-76fb-032a-2bd346ca2a03"
      },
      "outputs": [],
      "source": [
        "empyr.empee.sex <- employee.employer.crime %>%\n",
        "                                                group_by(victim.sex, \n",
        "                                                perpetrator.sex,\n",
        "                                                who.killed.who.sex,\n",
        "                                                 relationship) %>%\n",
        "                  summarise(sex.freq = n()) %>%\n",
        "                  arrange(victim.sex, perpetrator.sex)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "8257f8e1-225e-5800-32bf-32ffab27cee3"
      },
      "source": [
        "# Plots\n",
        "\n",
        "First i would like to create a special theme for this Kernel."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "e366a782-55f1-c152-68bf-c310b71a5d97"
      },
      "outputs": [],
      "source": [
        "#################################################\n",
        "homi.theme<-theme(\n",
        "  axis.text = element_text(size = 8),\n",
        "  axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 0.5),\n",
        "  axis.title = element_text(size = 14),\n",
        "  panel.grid.major = element_line(color = \"grey\"),\n",
        "  panel.grid.minor = element_blank(),\n",
        "  panel.background = element_rect(fill = \"snow1\"),\n",
        "  legend.position = \"right\",\n",
        "  legend.justification = \"top\", \n",
        "  legend.background = element_blank(),\n",
        "  panel.border = element_rect(color = \"black\", fill = NA, size = 1))\n",
        "####################################################\n",
        "\n",
        " tt.homi.f <- ttheme_minimal(\n",
        "    core=list(bg_params = list(fill = \"azure\", col=\"darkblue\"),\n",
        "              fg_params=list(fontface=6)),\n",
        "    colhead=list(fg_params=list(col=\"navyblue\", fontface=4L)))"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "bbd54aad-63eb-d2ca-6a10-d314d51bb345"
      },
      "outputs": [],
      "source": [
        "by.ndf.by.weapon.used$sex.weapon.used <- fct_inorder(by.ndf.by.weapon.used$sex.weapon.used )\n",
        "\n",
        "plot.gender.weapon.used.T20 <- ggplot(by.ndf.by.weapon.used[1:20,],aes(x = sex.weapon.used,y=freq.by.weapon.used))+\n",
        "  geom_bar(stat=\"identity\",fill=\"darkred\",width=0.5)+\n",
        "  homi.theme+\n",
        "  ggtitle(\"Top 20 \\n Female VS Male VS Weapon Used \\n 18+\")+\n",
        "  labs(x=\"Gender and Weapon Used\",\n",
        "       y=\"Number of Incidents\")+\n",
        "  theme(axis.text.x=element_text(size= 6, angle=90,hjust = 0.5)) \n",
        "\n",
        "plot.gender.weapon.used.T20"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "55c2eb0d-afbe-fc9f-5a7e-52a3150918e0"
      },
      "outputs": [],
      "source": [
        "by.ndf.by.weapon.used$sex.weapon.used <- fct_inorder(by.ndf.by.weapon.used$sex.weapon.used )\n",
        "\n",
        "plot.gender.weapon.used <- ggplot(by.ndf.by.weapon.used,aes(x = sex.weapon.used,y=freq.by.weapon.used))+\n",
        "  geom_bar(stat=\"identity\",fill=\"darkred\",width=0.5)+\n",
        "  homi.theme+\n",
        "  ggtitle(\"Female VS Male VS Weapon Used \\n 18+\")+\n",
        "  labs(x=\"Gender and Weapon Used\",\n",
        "       y=\"Number of Incidents\")+\n",
        "  theme(axis.text.x=element_text(size= 6, angle=90,hjust = 0.5)) \n",
        "\n",
        "plot.gender.weapon.used"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "5f3c7c3f-ec7b-4d11-d22d-ff82736d9ec4"
      },
      "outputs": [],
      "source": [
        "Plot.weapon.used <- ggplot(by.weapon,aes(x = weapon,y=freq.by.weapon))+\n",
        "geom_bar(stat = \"identity\",fill=\"red\",width = 0.5)+\n",
        "  homi.theme+\n",
        "  ggtitle(\"Weapon used\")+\n",
        "  labs(x=\"Weapon\",\n",
        "       y=\"Number of Incidents\")+\n",
        "  theme(axis.text.x=element_text(size= 8, angle=90,hjust = 0.5))\n",
        "\n",
        "\n",
        "\n",
        "plot.Weapon.vs.gender <- ggplot(by.weapon.sex,aes(x = weapon,y=freq.by.weapon))+\n",
        "geom_bar(stat = \"identity\",fill=\"red\",width=0.5)+\n",
        "  facet_wrap(~ victim.sex)+\n",
        "  homi.theme+\n",
        "  ggtitle(\"Female Killed by: \\n Male killed by: \\n 18+\")+\n",
        "  labs(x=\"Weapon\",\n",
        "       y=\"Number of Incidents\")+\n",
        "  theme(axis.text.x=element_text(size= 6, angle=90,hjust = 0.5))\n",
        "\n",
        "grid.arrange(Plot.weapon.used,\n",
        "             plot.Weapon.vs.gender,\n",
        "             ncol=1)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "fde81a05-0bbc-b4c8-fb9c-30f2b80536e2"
      },
      "source": [
        "# Who Killed Who?  ( Familicide )"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "fc6bde36-c8ed-70bd-3f46-f918d8cbd5da"
      },
      "outputs": [],
      "source": [
        "by.family$who.killed.who<- fct_inorder(by.family$who.killed.who)  \n",
        "  \n",
        "  plot.by.family <- ggplot(by.family,aes(x=who.killed.who, y=total.number.re ))+geom_bar(stat=\"identity\", fill=\"darkred\",width = 0.5)+\n",
        "    theme(axis.text.x=element_text(size= 8, angle=90,hjust = 0.5))+\n",
        "    homi.theme+\n",
        "    ggtitle(\"Who Killed Who! \\n \\n Number of Incidents VS Family Relationship\")+\n",
        "    labs(x=\"Family relationship\",\n",
        "         y=\"Number of Incidents\")\n",
        " \n",
        " table.by.family <- tableGrob(by.family, rows=NULL,theme = tt.homi.f)\n",
        " \n",
        " grid.arrange(plot.by.family,\n",
        "              table.by.family,ncol=2)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "ccc6f67c-cceb-8905-df64-385680cab97d"
      },
      "source": [
        "It is painful numbers, but good to know ... no need to explain what  is already there...\n",
        "These two plots need a rich imagination and strong brainstorming. "
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "4f5002fb-5073-21e5-d3e1-7d6003dba36d"
      },
      "source": [
        "**Friends VS Sex**"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "de37db03-1fc5-cd96-0ec5-d6c390fd8e57"
      },
      "outputs": [],
      "source": [
        "ggplot(friend.crime, aes(x= who.killed.who.Friend.sex))+\n",
        "  geom_bar(alpha=0.8,fill=\"steelblue\", width=0.3)+\n",
        "  homi.theme+\n",
        "  ggtitle(\"Victims \\n Who Killed Who? \\n Freinds VS Sex\")+\n",
        "  labs(x=\"Who Killed Who?\",\n",
        "       y=\"Number of Incidents\")+\n",
        "  theme(axis.text.x=element_text(size= 8, angle=90,hjust = 0.5))"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "0898644f-2afa-1e96-7d46-0c7c6f6866d3"
      },
      "source": [
        "**Again men ...NO COMMENTS !**"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "f919417e-063b-d3ca-8c07-854b52563889"
      },
      "source": [
        "**Employee VS Employer**"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "1e0f77be-8964-b516-0afb-0e6d6f208206"
      },
      "outputs": [],
      "source": [
        "ggplot(empyr.empee.sex ,aes(x = who.killed.who.sex, y=sex.freq, fill=relationship))+\n",
        "  geom_bar(stat=\"identity\", alpha=0.4,col=\"gold\", width=0.4)+facet_wrap(~ relationship)+\n",
        "  homi.theme+\n",
        "  ggtitle(\"Victims \\n Employee VS Employer \\n Male VS Female \\n Who Killed by Who?\")+\n",
        "  labs(x= \"Who Killed by Who\",\n",
        "       y= \"Number of incidents\")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "73402b10-4811-94fe-1600-d6c72693438f"
      },
      "outputs": [],
      "source": [
        "ggplot(employee.employer.crime ,aes(x=relationship,fill = relationship))+\n",
        "  geom_bar(alpha=0.4,col=\"gold\", width=0.4)+\n",
        "  homi.theme+\n",
        "  ggtitle(\"Victims \\n Employee VS Employer\")+labs(x= \"Relationship\",\n",
        "                                                  y= \"Number of incidents\")"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "f2e92a16-56d6-70a5-1159-a47922febbb7"
      },
      "source": [
        "# Ex-Husband VS Ex-Wife / Older or Younger"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "4688771f-fcdd-4570-affb-6166b015102f"
      },
      "outputs": [],
      "source": [
        "ex.h.vs.ex.w <- ggplot(ex.husband.ex.wife.crime ,aes(x=relationship,fill = relationship))+\n",
        "  geom_bar(alpha=0.4,col=\"gold\", width=0.4)+\n",
        "  homi.theme+\n",
        "  ggtitle(\"Victims \\n Ex-Husband VS Ex-Wife\")+labs(x= \"Relationship\",\n",
        "                                                   y= \"Number of incidents\")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "9dc5fb07-71e0-2939-19b8-9ce8c943f6b0"
      },
      "outputs": [],
      "source": [
        "ex.h.vs.ex.w.age <- ggplot(ex.husband.ex.wife.crime, aes(x= older.or.younger))+geom_bar(alpha=0.7,fill=\"gold3\", width=0.3)+\n",
        "  homi.theme+\n",
        "  ggtitle(\"Victims \\n Ex-Husband VS Ex-Wife VS Age\")+\n",
        "  labs(x=\"Older and Yonger\",\n",
        "       y=\"Number of Incidents\")+\n",
        "  theme(axis.text.x=element_text(size= 8, angle=90,hjust = 0.5))"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "b74be7d2-0dbc-ab92-bc52-61349796b157"
      },
      "outputs": [],
      "source": [
        "\n",
        "grid.arrange(ex.h.vs.ex.w,\n",
        "             ex.h.vs.ex.w.age,ncol=2)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "60b26b6f-b5b8-d7c9-8a5e-8d446321cc87"
      },
      "source": [
        "**No Comments !**"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "81fe0ffb-e793-1a6b-46b1-5421e506af63"
      },
      "source": [
        " **The incidents happened between the Boyfriends and Girlfriends.**"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "14520aa6-27cb-db3e-052d-a851dc8f1644"
      },
      "outputs": [],
      "source": [
        "plot.gf.bf.vic<-ggplot(girl.boy.crime ,aes(x=victim.sex,fill=victim.sex))+\n",
        "  geom_bar(alpha=0.4,col=\"gold\", width=0.4)+\n",
        "  homi.theme+\n",
        "  ggtitle(\"Victims \\n Girlfriend VS Boyfriend\")+labs(x= \"Gender\",\n",
        "                              y= \"Number of incidents\")\n",
        "\n",
        "plot.gf.bf.pre<-ggplot(girl.boy.crime ,aes(x=perpetrator.sex, fill=perpetrator.sex))+\n",
        "  geom_bar(alpha=0.4,col=\"gold\", width = 0.4)+\n",
        "  homi.theme+\n",
        "  ggtitle(\"Perpetrators \\n Girlfriend VS Boyfriend\")+labs(x= \"Gender\",\n",
        "                                     y= \"Number of incidents\")\n",
        "\n",
        "grid.arrange(plot.gf.bf.vic,\n",
        "             plot.gf.bf.pre,\n",
        "             ncol=2)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "ce7982c7-09ce-92af-bd2b-9f5f76041d0e"
      },
      "source": [
        "Regardless of the crime type, we see that the Male is much more than female as Perpetrators and Vice Versa."
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "418d892a-d395-224a-9b26-53897b100b4e"
      },
      "source": [
        "# Incidents per year and States"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "_cell_guid": "5f6ba15f-1340-2427-7a77-5dd43def11b9"
      },
      "outputs": [],
      "source": [
        "  plot.homic.years<-ggplot(data = by.year,\n",
        "                         aes(x=as.numeric(year),\n",
        "                             y=freq.year))+\n",
        "    geom_line(size=2,col=\"yellow3\")+\n",
        "    homi.theme+\n",
        "    ggtitle(\"Number of incidents occurred per Year\")+\n",
        "    labs(x=\"Year\",\n",
        "         y=\"Number of Incidents\")+\n",
        "    theme(axis.text.x=element_text(size= 5, angle=90,hjust = 0.5))\n",
        "  \n",
        "  plot.homic.years.points<-ggplot(data = by.year,\n",
        "                                aes(x=as.factor(year),\n",
        "                                    y=freq.year))+\n",
        "    geom_point(size=1,col=\"blue\")+\n",
        "    homi.theme+\n",
        "    ggtitle(\"Number of Incidents occurred per Year\")+\n",
        "    labs(x=\"Year\",\n",
        "         y=\"Number of Incidents\")+\n",
        "    theme(axis.text.x=element_text(size= 5, angle=90,hjust = 0.5))\n",
        "  \n",
        "  \n",
        "  by.state$state <- fct_inorder(by.state$state)\n",
        "  plot.by.state <- ggplot(data = by.state,\n",
        "                          aes(x=as.factor(state),\n",
        "                              y=freq.by.state))+\n",
        "    geom_bar(stat= \"identity\", fill=\"darkred\", width=0.5 )+\n",
        "    homi.theme+\n",
        "    ggtitle(\"Number of Incidents occurred per Year\")+\n",
        "    labs(x=\"State\",\n",
        "         y=\"Number of Incidents\")+\n",
        "    theme(axis.text.x=element_text(size= 6, angle=90,hjust = 0.5))\n",
        "  \n",
        "  grid.arrange(arrangeGrob(plot.homic.years,plot.homic.years.points,ncol=2),\n",
        "               plot.by.state)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "cbe8f6d8-ba30-a017-1fd4-99520c24a1a2"
      },
      "source": [
        " **1993** has the larger number of crimes, I wander why? is it a sensible question ?\n",
        "  and from 1994 up to 2014 we can easily see that it is trend-down..which is very nice and generating a **big question** as well !\n",
        "  "
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "_cell_guid": "4582166b-dad9-3bab-3b02-32a1445c6ec9"
      },
      "source": [
        "The next step is to see the time-line trend of each observation, to see for example the trend of Wife Killed by Husband along the time-line from 1980 to 2014.. \n",
        "\n",
        "Sorry the kernel ended at this stage... my time is too short, and hope i will proceed shortly... \n",
        "Thanks and more will **follow.**\n",
        "\n",
        "You can check the Section below link for Wepon used..\n",
        " \n",
        "https://www.kaggle.com/khsamaha/d/murderaccountability/homicide-reports/weapon-used-vs-gender-who-killed-who \n",
        "\n",
        "Your comments are most welcome! and please **upvote** if you liked it."
      ]
    }
  ],
  "metadata": {
    "_change_revision": 0,
    "_is_fork": false,
    "kernelspec": {
      "display_name": "R",
      "language": "R",
      "name": "ir"
    },
    "language_info": {
      "codemirror_mode": "r",
      "file_extension": ".r",
      "mimetype": "text/x-r-source",
      "name": "R",
      "pygments_lexer": "r",
      "version": "3.4.0"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}