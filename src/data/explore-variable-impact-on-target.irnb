{"cells":[{"metadata":{"_uuid":"9512541f8320364813a65d710a76a35a1757feec"},"cell_type":"markdown","source":"***Visualize impact of each variable on the target***"},{"metadata":{"_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","trusted":true},"cell_type":"code","source":"#### Initialization ####\nlibrary(tidyverse)\nlibrary(hexbin)","execution_count":null,"outputs":[]},{"metadata":{"_cell_guid":"79c7e3d0-c299-4dcb-8224-4455121ee9b0","_uuid":"d629ff2d2480ee46fbb7e2d37f6b5fab8052498a","trusted":true},"cell_type":"code","source":"# read original data (training) from file\nt1 <- proc.time()\ndf <- read.csv(file='../input/train_V2.csv', sep=',')\ncolnames(df) <- toupper(colnames(df))\nt2 <- proc.time()\nprint(t2-t1)","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"7913285dba7043538476291b14b6ff8e60982ace"},"cell_type":"code","source":"# first look into data\nstr(df)","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"c68218ead17d60d0fbf5a29c84c459b887fe3072"},"cell_type":"code","source":"#### Conversions and more detailed glance at data ####\n\ndf$ID <- as.factor(df$ID)\ndf$GROUPID <- as.factor(df$GROUPID)\ndf$MATCHID <- as.factor(df$MATCHID)\n\ndf$TARGET <- df$WINPLACEPERC\ndf$WINPLACEPERC <- NULL\n\nhist(df$TARGET, 20, freq = FALSE)\n\nsummary(df)","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"9c66f6f2b6525fa8d3af2ba33b6ea60e9c3dc078"},"cell_type":"code","source":"# One target value is missing => remove row\ndf <- dplyr::filter(df, !is.na(TARGET))","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"74fe0c7d35bcf097c4d291de32fff69e92edb873"},"cell_type":"markdown","source":"**Define relevant numeric variables**"},{"metadata":{"trusted":true,"_uuid":"3202abbb86b9716aa11803596899ab7c60931df0"},"cell_type":"code","source":"my.vars <- c(\n  'ASSISTS',\n  'BOOSTS',\n  'DAMAGEDEALT',\n  'DBNOS',\n  'HEADSHOTKILLS',\n  'HEALS',\n  'KILLPLACE',\n  'KILLPOINTS',\n  'KILLS',\n  'KILLSTREAKS',\n  'LONGESTKILL',\n  'MATCHDURATION',\n  'MAXPLACE',\n  'NUMGROUPS',\n  'RANKPOINTS',\n  'REVIVES',\n  'RIDEDISTANCE',\n  'ROADKILLS',\n  'SWIMDISTANCE',\n  'TEAMKILLS',\n  'VEHICLEDESTROYS',\n  'WALKDISTANCE',\n  'WEAPONSACQUIRED',\n  'WINPOINTS'\n)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"b50d0b798c202a6757a7b2acc35c30764637e99d"},"cell_type":"markdown","source":"**Evaluate rank correlations**"},{"metadata":{"trusted":true,"_uuid":"7b4a9ea230adaaebec4ead0bac87540b8b5e2e7d"},"cell_type":"code","source":"# evaluate rank correlations of each variable with target\nn.vars <- length(my.vars)\nstats.cor <- as.data.frame(cbind(my.vars,1:n.vars))\ncolnames(stats.cor) <- c('Variable','Spearman')\nstats.cor$Spearman <- as.numeric(stats.cor$Spearman)\nfor (i in 1:n.vars) {\n  current.var <- my.vars[i]\n  current.cor <- cor(df[,current.var], df$TARGET, method='spearman')\n  stats.cor$Spearman[i] <- current.cor\n}\nprint(stats.cor)","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"5a9c66feff05bd37dedcea392105117adba6059e"},"cell_type":"code","source":"# plot using ggplot2\np <- ggplot(data=stats.cor, aes(x=Variable, y=Spearman, fill=Variable))\n  p <- p + geom_col(colour='black') # barchart + black border\n  p <- p + labs(title = 'Spearman correlation with target', x='Covariate') # add title\n  p <- p + theme(axis.text.x = element_text(angle = 90, hjust = 1), plot.title = element_text(hjust=0.5)) # rotate x-axis labels + center title\n  p <- p + guides(fill='none') # do not show legend\n  p","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"7d8789401eaa112d16f562e781d8b9f1bf266ca8"},"cell_type":"markdown","source":"**Create scatterplots for all variables - Results can be found in \"Output\" Section**"},{"metadata":{"trusted":true,"_uuid":"b4921f75162506ca44f9bf026de8106216f93b0f"},"cell_type":"code","source":"n.vars <- length(my.vars)\nfor (i in 1:n.vars) {\n  current.var <- my.vars[i]\n  current.cor <- stats.cor$Spearman[i]\n  my.title <- paste0('TARGET vs metric, spearman corr = ', round(current.cor,4))\n  fname <- paste0('plot_metric_',current.var,'.png' )\n  png(filename=fname, width=800, height=600)\n  smoothScatter(df[,current.var],df$TARGET, main = my.title, xlab = current.var)  \n  dev.off()\n}","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"2c6e1b7073ac75dfb957b2aa4c6bec14a9a29a5b"},"cell_type":"markdown","source":"**One example:**"},{"metadata":{"trusted":true,"_uuid":"36c23d97bf82f22abad1fd6fde5973e6478f0e87"},"cell_type":"code","source":"i <- 7\ncurrent.var <- my.vars[i]\ncurrent.cor <- stats.cor$Spearman[i]\nmy.title <- paste0('TARGET vs metric, spearman corr = ', round(current.cor,4))\nsmoothScatter(df[,current.var],df$TARGET, main = my.title, xlab = current.var)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"9ebe805f48f564dd608ca82e07a6b0b3ecb2a262"},"cell_type":"markdown","source":"**Another visualization style:**"},{"metadata":{"trusted":true,"_uuid":"cf2de8546fdf773c76580d2c883f52c83d3810ea"},"cell_type":"code","source":"# dirrerent plot type, one example only\nhexbinplot(df$TARGET ~ df$KILLPLACE, aspect = 1)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"3578f3e2d326058ad6f4e8895d2d1b3b67d7eca1"},"cell_type":"markdown","source":"**Yet another visualization style:**"},{"metadata":{"trusted":true,"_uuid":"083103cd9b2b0d7ce8a712b4d200726f6ef59486"},"cell_type":"code","source":"plot(df[,current.var],df$TARGET, main = my.title, xlab = current.var, col='#00000001')","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"ee852cab24f46e83cedcb9a474eef89349892c0b"},"cell_type":"markdown","source":"**Look at new variable RANKPOINTS**"},{"metadata":{"trusted":true,"_uuid":"2883fc7879b1e8113654b68603882cf256c70b2d"},"cell_type":"code","source":"hist(df$RANKPOINTS,100)","execution_count":null,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"86e90ae2e4e29808d92840c7d0999bafce23fa47"},"cell_type":"code","source":"par(mar=c(5+5,4,4,2)) # more space for x-labels\nplot(cut(df$RANKPOINTS,20), df$TARGET, las=2)","execution_count":null,"outputs":[]}],"metadata":{"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"3.4.2","file_extension":".r","codemirror_mode":"r"}},"nbformat":4,"nbformat_minor":1}